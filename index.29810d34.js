const e=new class{constructor(e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){console.log(e),this.initialState=this.boardDeepCopy(e),this.board=this.boardDeepCopy(e),this.score=0,this.status="idle"}moveLeft(){this.performMove(e=>this.joinTiles(e))}moveRight(){this.performMove(e=>this.reverse(this.joinTiles(this.reverse(e))))}moveUp(){this.performMove(e=>{let t=this.transpose(e),s=this.joinTiles(t);return this.transpose(s)})}moveDown(){this.performMove(e=>{let t=this.transpose(e),s=this.reverse(t),r=this.joinTiles(s),i=this.reverse(r);return this.transpose(i)})}getScore(){return this.score}getState(){return this.boardDeepCopy(this.board)}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.status="idle",this.board=this.boardDeepCopy(this.initialState),this.score=0}addRandomTile(){let e=this.board.reduce((e,t,s)=>(t.forEach((t,r)=>{0===t&&e.push({row:s,col:r})}),e),[]);if(e.length>0){let{row:t,col:s}=e[Math.floor(Math.random()*e.length)];this.board[t][s]=.9>Math.random()?2:4}this.isGameOver()&&(this.status="lose")}joinTiles(e){return e.map(e=>{let t=e.filter(e=>0!==e);for(let e=0;e<t.length;e++)t[e]===t[e+1]&&(t[e]*=2,this.score+=t[e],2048===t[e]&&(this.status="win"),t.splice(e+1,1));for(;t.length<4;)t.push(0);return t})}transpose(e){return e[0].map((t,s)=>e.map(e=>e[s]))}reverse(e){return e.map(e=>e.reverse())}boardDeepCopy(e){return JSON.parse(JSON.stringify(e))}isGameOver(){for(let e=0;e<4;e++)for(let t=0;t<4;t++){let s=this.board[e][t];if(0===this.board[e][t]||e<3&&s===this.board[e+1][t]||t<3&&s===this.board[e][t+1])return!1}return!0}performMove(e){if("playing"!==this.status)return;let t=JSON.stringify(this.board);this.board=e(this.board),JSON.stringify(this.board)!==t&&this.addRandomTile()}},t=document.querySelector(".button"),s=document.querySelector(".game-score"),r=document.querySelector(".message-win"),i=document.querySelector(".message-lose"),o=document.querySelector(".message-start"),a=document.querySelector(".game-field");function n(t){let r=a.querySelectorAll(".field-cell");t.flat().forEach((e,t)=>{let s=r[t];s.textContent=0===e?"":e,s.className=`field-cell ${e>0?`field-cell--${e}`:""}`}),s.textContent=e.getScore()}document.addEventListener("keyup",t=>{if("playing"===e.status){switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowRight":e.moveRight();break;case"ArrowLeft":e.moveLeft()}n(e.board),"win"===e.getStatus()&&r.classList.remove("hidden"),"lose"===e.getStatus()&&i.classList.remove("hidden")}}),t.addEventListener("click",t=>{let s=t.target;s.classList.contains("start")?(e.start(),s.classList.replace("start","restart"),s.textContent="Restart",o.classList.add("hidden")):(e.restart(),s.classList.replace("restart","start"),s.textContent="Start",o.classList.remove("hidden"),r.classList.add("hidden"),i.classList.add("hidden")),n(e.board)});
//# sourceMappingURL=index.29810d34.js.map
